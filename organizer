#!/usr/bin/env bash

set -euo pipefail
trap 'echo "Error on line $LINENO"' ERR

ensure_dir_and_move() {
  declare -n dir=$1
  declare -n itemTobeMoved=$2
  if [[ -d $dir ]]; then
    mv "$itemTobeMoved" "$dir"
  else
    mkdir "$dir"
    mv "$itemTobeMoved" "$dir"
  fi
}

organize_files_by_type() {

  for extension in *; do
    if [[ -d $extension ]]; then
      continue
    fi
    case "${extension}" in
    # Documents
    *.pdf | *.doc | *.docx | *.txt | *.rtf | *.odt | *.md)
      local category="Documents"
      ensure_dir_and_move category extension
      echo "these are $category"

      ;;
    *.xls | *.xlsx | *.csv | *.ods)
      local category="Spreadsheets"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;
    *.ppt | *.pptx | *.odp)
      local category="Presentations"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;

    # Images
    *.jpg | *.jpeg | *.png | *.gif | *.bmp | *.svg | *.webp | *.ico | *.tiff | *.tif)
      local category="Images"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;

    # Videos
    *.avi | *.mkv | *.mov | *.wmv | *.flv | *.webm | *.m4v | *.mpg | *.mpeg | *.mp4)
      local category="Videos"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;

    # Audio
    *.mp3 | *.wav | *.flac | *.aac | *.ogg | *.m4a | *.wma | *.opus)
      local category="Audio"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;

    # Archives
    *.zip | *.rar | *.tar | *.gz | *.7z | *.bz2 | *.xz | *.tgz)
      local category="Archives"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;

    # Code
    *.py | *.java | *.cpp | *.c | *.h | *.js | *.ts | *.html | *.css | *.php | *.rb | *.go | *.rs | *.swift)
      local category="Code"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;

    # Executables
    *.exe | *.app | *.deb | *.rpm | *.apk | *.dmg | *.msi)
      local category="Executables"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;

    # Default
    *)
      local category="Other"
      echo "these are $category"
      ensure_dir_and_move category extension
      ;;
    esac
  done
}
